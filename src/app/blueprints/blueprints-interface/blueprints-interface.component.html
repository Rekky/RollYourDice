<div class="blueprints-container">
    <div class="buttons-box p-3">
        <button type="button" class="btn btn-white px-3 my-2"
                (click)="addBBArea()">Area</button>
        <button type="button" class="btn btn-white px-3 my-2"
                (click)="addBBGetAllActors()">GetAllActors</button>
        <button type="button" class="btn btn-white px-3 my-2"
                (click)="addBBEquals()">Equals</button>
        <button type="button" class="btn btn-white px-3 my-2"
                (click)="addBBGet()">Get</button>
        <button type="button" class="btn btn-white px-3 my-2"
                (click)="addBBMoveActorToLocation()">MoveActorToLocation</button>
        <button type="button" class="btn btn-white px-3 my-2"
                (click)="addBBOnInit()">OnInit</button>
        <button type="button" class="btn btn-white px-3 my-2"
                (click)="addBBOnOverlap()">OnOverlap</button>
    </div>
    <div class="frame" (click)="clickedOnFrame($event)">
        <div appDroppable class="canvas droppable" #droppable
             [options]="{ accept: '.draggable' }"
             (dropping)="elementDropped($event)">

            <svg *ngIf="temporalLink" class="link" #svg
                 [style.left]="temporalLink.position.x + 'px'"
                 [style.top]="temporalLink.position.y + 'px'"
                 [style.width]="getLinkWidth(temporalLink) + 'px'"
                 [style.height]="getLinkHeight(temporalLink) + 'px'"
                 xmlns="http://www.w3.org/2000/svg">
                <path [attr.d]="getSVGPath(temporalLink)"
                      transform
                      pointer-events="visibleStroke"
                      fill="none"
                      stroke="#FFFFFF"
                      stroke-width="2"></path>
            </svg>
            <ng-container *ngFor="let link of blueprint.blueprintLinks">
                <svg class="link" #svg
                     [style.left]="link.position.x + 'px'"
                     [style.top]="link.position.y + 'px'"
                     [style.width]="getLinkWidth(link) + 'px'"
                     [style.height]="getLinkHeight(link) + 'px'"
                     xmlns="http://www.w3.org/2000/svg">
                    <path *ngIf="selectedLink?.id !== link?.id" [attr.d]="getSVGPath(link)"
                          (click)="toggleLinkSelection(link)"
                          transform
                          pointer-events="visibleStroke"
                          fill="none"
                          stroke="#FFFFFF"
                          stroke-width="2"></path>
                    <path *ngIf="selectedLink?.id === link?.id" [attr.d]="getSVGPath(link)"
                          (click)="toggleLinkSelection(link)"
                          class="selected-link"
                          transform
                          pointer-events="visibleStroke"
                          fill="none"
                          stroke="#CFB525"
                          stroke-width="2"></path>
                    <path [attr.d]="getSVGPath(link)"
                          (click)="toggleLinkSelection(link)"
                          (mouseenter)="mouseHoversLink($event, link)"
                          (mouseleave)="mouseLeavesLink($event, link)"
                          transform
                          pointer-events="visibleStroke"
                          fill="none"
                          stroke="transparent"
                          stroke-width="15"></path>
                </svg>
            </ng-container>
            <ng-container *ngFor="let bb of blueprint.blueprintBoxes;">
                <app-bb-area *ngIf="bb.kind === 'AREA'"
                             appDraggable
                             class="draggable"
                             [bb]="bb"
                             [id]="bb.id"
                             [style.top]="bb.position.y + 'px'"
                             [style.left]="bb.position.x + 'px'"
                             [objectData]="bb"
                             (nodeOutHasBeenTouched)="touchedNodeOut($event)"
                             (nodeInHasBeenTouched)="touchedNodeIn($event)"
                             (draggableClick)="clickedBB($event)"
                             (dragging)="modifyBBPosition($event, bb)">
                </app-bb-area>
                <app-bb-get-all-actors *ngIf="bb.kind === 'GET_ALL_ACTORS'"
                             appDraggable
                             class="draggable"
                             [bb]="bb"
                             [id]="bb.id"
                             [style.top]="bb.position.y + 'px'"
                             [style.left]="bb.position.x + 'px'"
                             [objectData]="bb"
                             (nodeOutHasBeenTouched)="touchedNodeOut($event)"
                             (nodeInHasBeenTouched)="touchedNodeIn($event)"
                             (draggableClick)="clickedBB($event)"
                             (dragging)="modifyBBPosition($event, bb)">
                </app-bb-get-all-actors>
                <app-bb-equals *ngIf="bb.kind === 'EQUALS'"
                                       appDraggable
                                       class="draggable"
                                       [bb]="bb"
                                       [id]="bb.id"
                                       [style.top]="bb.position.y + 'px'"
                                       [style.left]="bb.position.x + 'px'"
                                       [objectData]="bb"
                                       (nodeOutHasBeenTouched)="touchedNodeOut($event)"
                                       (nodeInHasBeenTouched)="touchedNodeIn($event)"
                                       (draggableClick)="clickedBB($event)"
                                       (dragging)="modifyBBPosition($event, bb)">
                </app-bb-equals>
                <app-bb-get *ngIf="bb.kind === 'GET'"
                               appDraggable
                               class="draggable"
                               [bb]="bb"
                               [id]="bb.id"
                               [style.top]="bb.position.y + 'px'"
                               [style.left]="bb.position.x + 'px'"
                               [objectData]="bb"
                               (nodeOutHasBeenTouched)="touchedNodeOut($event)"
                               (nodeInHasBeenTouched)="touchedNodeIn($event)"
                               (draggableClick)="clickedBB($event)"
                               (dragging)="modifyBBPosition($event, bb)">
                </app-bb-get>
                <app-bb-move-actor-to-location *ngIf="bb.kind === 'MOVE_ACTOR_TO_LOCATION'"
                               appDraggable
                               class="draggable"
                               [bb]="bb"
                               [id]="bb.id"
                               [style.top]="bb.position.y + 'px'"
                               [style.left]="bb.position.x + 'px'"
                               [objectData]="bb"
                               (nodeOutHasBeenTouched)="touchedNodeOut($event)"
                               (nodeInHasBeenTouched)="touchedNodeIn($event)"
                               (draggableClick)="clickedBB($event)"
                               (dragging)="modifyBBPosition($event, bb)">
                </app-bb-move-actor-to-location>
                <app-bb-on-init *ngIf="bb.kind === 'ON_INIT'"
                                               appDraggable
                                               class="draggable"
                                               [bb]="bb"
                                               [id]="bb.id"
                                               [style.top]="bb.position.y + 'px'"
                                               [style.left]="bb.position.x + 'px'"
                                               [objectData]="bb"
                                               (nodeOutHasBeenTouched)="touchedNodeOut($event)"
                                               (nodeInHasBeenTouched)="touchedNodeIn($event)"
                                               (draggableClick)="clickedBB($event)"
                                               (dragging)="modifyBBPosition($event, bb)">
                </app-bb-on-init>
                <app-bb-on-overlap *ngIf="bb.kind === 'ON_OVERLAP'"
                                               appDraggable
                                               class="draggable"
                                               [bb]="bb"
                                               [id]="bb.id"
                                               [style.top]="bb.position.y + 'px'"
                                               [style.left]="bb.position.x + 'px'"
                                               [objectData]="bb"
                                               (nodeOutHasBeenTouched)="touchedNodeOut($event)"
                                               (nodeInHasBeenTouched)="touchedNodeIn($event)"
                                               (draggableClick)="clickedBB($event)"
                                               (dragging)="modifyBBPosition($event, bb)">
                </app-bb-on-overlap>
            </ng-container>
        </div>
    </div>
</div>
